SELECT ttt.lug_id,ttt.lug_x,ttt.lug_y,
    sum(ttt.tmax80) tmax80,
    sum(ttt.tmed80) tmed80,
    sum(ttt.tmin80) tmin80,
    sum(ttt.pre80) pre80,
    sum(ttt.tmax81) tmax81,
    sum(ttt.tmed81) tmed81,
    sum(ttt.tmin81) tmin81,
    sum(ttt.pre81) pre81,
  sum(ttt.tmax82) tmax82,
    sum(ttt.tmed82) tmed82,
    sum(ttt.tmin82) tmin82,
    sum(ttt.pre82) pre82,
  sum(ttt.tmax83) tmax83,
    sum(ttt.tmed83) tmed83,
    sum(ttt.tmin83) tmin83,
    sum(ttt.pre83) pre83,
  sum(ttt.tmax84) tmax84,
    sum(ttt.tmed84) tmed84,
    sum(ttt.tmin84) tmin84,
    sum(ttt.pre84) pre84,
  sum(ttt.tmax85) tmax85,
    sum(ttt.tmed85) tmed85,
    sum(ttt.tmin85) tmin85,
    sum(ttt.pre85) pre85,
  sum(ttt.tmax86) tmax86,
    sum(ttt.tmed86) tmed86,
    sum(ttt.tmin86) tmin86,
    sum(ttt.pre86) pre86,
  sum(ttt.tmax87) tmax87,
    sum(ttt.tmed87) tmed87,
    sum(ttt.tmin87) tmin87,
    sum(ttt.pre87) pre87,
  sum(ttt.tmax88) tmax88,
    sum(ttt.tmed88) tmed88,
    sum(ttt.tmin88) tmin88,
    sum(ttt.pre88) pre88,
  sum(ttt.tmax89) tmax89,
    sum(ttt.tmed89) tmed89,
    sum(ttt.tmin89) tmin89,
    sum(ttt.pre89) pre89,
  sum(ttt.tmax90) tmax90,
    sum(ttt.tmed90) tmed90,
    sum(ttt.tmin90) tmin90,
    sum(ttt.pre90) pre90,
    sum(ttt.tmax91) tmax91,
    sum(ttt.tmed91) tmed91,
    sum(ttt.tmin91) tmin91,
    sum(ttt.pre91) pre91,
  sum(ttt.tmax92) tmax92,
    sum(ttt.tmed92) tmed92,
    sum(ttt.tmin92) tmin92,
    sum(ttt.pre92) pre92,
  sum(ttt.tmax93) tmax93,
    sum(ttt.tmed93) tmed93,
    sum(ttt.tmin93) tmin93,
    sum(ttt.pre93) pre93,
  sum(ttt.tmax94) tmax94,
    sum(ttt.tmed94) tmed94,
    sum(ttt.tmin94) tmin94,
    sum(ttt.pre94) pre94,
  sum(ttt.tmax95) tmax95,
    sum(ttt.tmed95) tmed95,
    sum(ttt.tmin95) tmin95,
    sum(ttt.pre95) pre95,
  sum(ttt.tmax96) tmax96,
    sum(ttt.tmed96) tmed96,
    sum(ttt.tmin96) tmin96,
    sum(ttt.pre96) pre96,
  sum(ttt.tmax97) tmax97,
    sum(ttt.tmed97) tmed97,
    sum(ttt.tmin97) tmin97,
    sum(ttt.pre97) pre97,
  sum(ttt.tmax98) tmax98,
    sum(ttt.tmed98) tmed98,
    sum(ttt.tmin98) tmin98,
    sum(ttt.pre98) pre98,
  sum(ttt.tmax99) tmax99,
    sum(ttt.tmed99) tmed99,
    sum(ttt.tmin99) tmin99,
    sum(ttt.pre99) pre99,
  sum(ttt.tmax00) tmax00,
    sum(ttt.tmed00) tmed00,
    sum(ttt.tmin00) tmin00,
    sum(ttt.pre00) pre00,
    sum(ttt.tmax01) tmax01,
    sum(ttt.tmed01) tmed01,
    sum(ttt.tmin01) tmin01,
    sum(ttt.pre01) pre01,
  sum(ttt.tmax02) tmax02,
    sum(ttt.tmed02) tmed02,
    sum(ttt.tmin02) tmin02,
    sum(ttt.pre02) pre02,
  sum(ttt.tmax03) tmax03,
    sum(ttt.tmed03) tmed03,
    sum(ttt.tmin03) tmin03,
    sum(ttt.pre03) pre03,
  sum(ttt.tmax04) tmax04,
    sum(ttt.tmed04) tmed04,
    sum(ttt.tmin04) tmin04,
    sum(ttt.pre04) pre04,
  sum(ttt.tmax05) tmax05,
    sum(ttt.tmed05) tmed05,
    sum(ttt.tmin05) tmin05,
    sum(ttt.pre05) pre05,
  sum(ttt.tmax06) tmax06,
    sum(ttt.tmed06) tmed06,
    sum(ttt.tmin06) tmin06,
    sum(ttt.pre06) pre06,
  sum(ttt.tmax07) tmax07,
    sum(ttt.tmed07) tmed07,
    sum(ttt.tmin07) tmin07,
    sum(ttt.pre07) pre07,
  sum(ttt.tmax08) tmax08,
    sum(ttt.tmed08) tmed08,
    sum(ttt.tmin08) tmin08,
    sum(ttt.pre08) pre08,
  sum(ttt.tmax09) tmax09,
    sum(ttt.tmed09) tmed09,
    sum(ttt.tmin09) tmin09,
    sum(ttt.pre09) pre09,
  sum(ttt.pre10) pre10,
  sum(ttt.tmax10) tmax10,
    sum(ttt.tmed10) tmed10,
    sum(ttt.tmin10) tmin10,
    sum(ttt.tmax11) tmax11,
    sum(ttt.tmed11) tmed11,
    sum(ttt.tmin11) tmin11,
    sum(ttt.pre11) pre11,
  sum(ttt.tmax12) tmax12,
    sum(ttt.tmed12) tmed12,
    sum(ttt.tmin12) tmin12,
    sum(ttt.pre12) pre12,
  sum(ttt.tmax13) tmax13,
    sum(ttt.tmed13) tmed13,
    sum(ttt.tmin13) tmin13,
    sum(ttt.pre13) pre13
  FROM (
SELECT 
    tmp.lug_id,tmp.lug_x,tmp.lug_y,
    CASE WHEN csa_anio = 1980 THEN tmp.tmax_anual END AS tmax80,
    CASE WHEN csa_anio = 1980 THEN tmp.tmed_anual END AS tmed80,
    CASE WHEN csa_anio = 1980 THEN tmp.tmin_anual END AS tmin80,
    CASE WHEN csa_anio = 1980 THEN tmp.pre_anual END AS pre80,
    CASE WHEN csa_anio = 1981 THEN tmp.tmax_anual END AS tmax81,
    CASE WHEN csa_anio = 1981 THEN tmp.tmed_anual END AS tmed81,
    CASE WHEN csa_anio = 1981 THEN tmp.tmin_anual END AS tmin81,
    CASE WHEN csa_anio = 1981 THEN tmp.pre_anual END AS pre81,
  CASE WHEN csa_anio = 1982 THEN tmp.tmax_anual END AS tmax82,
    CASE WHEN csa_anio = 1982 THEN tmp.tmed_anual END AS tmed82,
    CASE WHEN csa_anio = 1982 THEN tmp.tmin_anual END AS tmin82,
    CASE WHEN csa_anio = 1982 THEN tmp.pre_anual END AS pre82,
  CASE WHEN csa_anio = 1983 THEN tmp.tmax_anual END AS tmax83,
    CASE WHEN csa_anio = 1983 THEN tmp.tmed_anual END AS tmed83,
    CASE WHEN csa_anio = 1983 THEN tmp.tmin_anual END AS tmin83,
    CASE WHEN csa_anio = 1983 THEN tmp.pre_anual END AS pre83,
  CASE WHEN csa_anio = 1984 THEN tmp.tmax_anual END AS tmax84,
    CASE WHEN csa_anio = 1984 THEN tmp.tmed_anual END AS tmed84,
    CASE WHEN csa_anio = 1984 THEN tmp.tmin_anual END AS tmin84,
    CASE WHEN csa_anio = 1984 THEN tmp.pre_anual END AS pre84,
    CASE WHEN csa_anio = 1985 THEN tmp.tmax_anual END AS tmax85,
    CASE WHEN csa_anio = 1985 THEN tmp.tmed_anual END AS tmed85,
    CASE WHEN csa_anio = 1985 THEN tmp.tmin_anual END AS tmin85,
    CASE WHEN csa_anio = 1985 THEN tmp.pre_anual END AS pre85,
    CASE WHEN csa_anio = 1986 THEN tmp.tmax_anual END AS tmax86,
    CASE WHEN csa_anio = 1986 THEN tmp.tmed_anual END AS tmed86,
    CASE WHEN csa_anio = 1986 THEN tmp.tmin_anual END AS tmin86,
    CASE WHEN csa_anio = 1986 THEN tmp.pre_anual END AS pre86,
    CASE WHEN csa_anio = 1987 THEN tmp.tmax_anual END AS tmax87,
    CASE WHEN csa_anio = 1987 THEN tmp.tmed_anual END AS tmed87,
    CASE WHEN csa_anio = 1987 THEN tmp.tmin_anual END AS tmin87,
    CASE WHEN csa_anio = 1987 THEN tmp.pre_anual END AS pre87,
    CASE WHEN csa_anio = 1988 THEN tmp.tmax_anual END AS tmax88,
    CASE WHEN csa_anio = 1988 THEN tmp.tmed_anual END AS tmed88,
    CASE WHEN csa_anio = 1988 THEN tmp.tmin_anual END AS tmin88,
    CASE WHEN csa_anio = 1988 THEN tmp.pre_anual END AS pre88,
    CASE WHEN csa_anio = 1989 THEN tmp.tmax_anual END AS tmax89,
    CASE WHEN csa_anio = 1989 THEN tmp.tmed_anual END AS tmed89,
    CASE WHEN csa_anio = 1989 THEN tmp.tmin_anual END AS tmin89,
    CASE WHEN csa_anio = 1989 THEN tmp.pre_anual END AS pre89
  CASE WHEN csa_anio = 1990 THEN tmp.tmax_anual END AS tmax90,
    CASE WHEN csa_anio = 1990 THEN tmp.tmed_anual END AS tmed90,
    CASE WHEN csa_anio = 1990 THEN tmp.tmin_anual END AS tmin90,
    CASE WHEN csa_anio = 1990 THEN tmp.pre_anual END AS pre90,
    CASE WHEN csa_anio = 1991 THEN tmp.tmax_anual END AS tmax91,
    CASE WHEN csa_anio = 1991 THEN tmp.tmed_anual END AS tmed91,
    CASE WHEN csa_anio = 1991 THEN tmp.tmin_anual END AS tmin91,
    CASE WHEN csa_anio = 1991 THEN tmp.pre_anual END AS pre91,
  CASE WHEN csa_anio = 1992 THEN tmp.tmax_anual END AS tmax92,
    CASE WHEN csa_anio = 1992 THEN tmp.tmed_anual END AS tmed92,
    CASE WHEN csa_anio = 1992 THEN tmp.tmin_anual END AS tmin92,
    CASE WHEN csa_anio = 1992 THEN tmp.pre_anual END AS pre92,
  CASE WHEN csa_anio = 1993 THEN tmp.tmax_anual END AS tmax93,
    CASE WHEN csa_anio = 1993 THEN tmp.tmed_anual END AS tmed93,
    CASE WHEN csa_anio = 1993 THEN tmp.tmin_anual END AS tmin93,
    CASE WHEN csa_anio = 1993 THEN tmp.pre_anual END AS pre93,
  CASE WHEN csa_anio = 1994 THEN tmp.tmax_anual END AS tmax94,
    CASE WHEN csa_anio = 1994 THEN tmp.tmed_anual END AS tmed94,
    CASE WHEN csa_anio = 1994 THEN tmp.tmin_anual END AS tmin94,
    CASE WHEN csa_anio = 1994 THEN tmp.pre_anual END AS pre94,
    CASE WHEN csa_anio = 1995 THEN tmp.tmax_anual END AS tmax95,
    CASE WHEN csa_anio = 1995 THEN tmp.tmed_anual END AS tmed95,
    CASE WHEN csa_anio = 1995 THEN tmp.tmin_anual END AS tmin95,
    CASE WHEN csa_anio = 1995 THEN tmp.pre_anual END AS pre95,
    CASE WHEN csa_anio = 1996 THEN tmp.tmax_anual END AS tmax96,
    CASE WHEN csa_anio = 1996 THEN tmp.tmed_anual END AS tmed96,
    CASE WHEN csa_anio = 1996 THEN tmp.tmin_anual END AS tmin96,
    CASE WHEN csa_anio = 1996 THEN tmp.pre_anual END AS pre96,
    CASE WHEN csa_anio = 1997 THEN tmp.tmax_anual END AS tmax97,
    CASE WHEN csa_anio = 1997 THEN tmp.tmed_anual END AS tmed97,
    CASE WHEN csa_anio = 1997 THEN tmp.tmin_anual END AS tmin97,
    CASE WHEN csa_anio = 1997 THEN tmp.pre_anual END AS pre97,
    CASE WHEN csa_anio = 1998 THEN tmp.tmax_anual END AS tmax98,
    CASE WHEN csa_anio = 1998 THEN tmp.tmed_anual END AS tmed98,
    CASE WHEN csa_anio = 1998 THEN tmp.tmin_anual END AS tmin98,
    CASE WHEN csa_anio = 1998 THEN tmp.pre_anual END AS pre98,
    CASE WHEN csa_anio = 1999 THEN tmp.tmax_anual END AS tmax99,
    CASE WHEN csa_anio = 1999 THEN tmp.tmed_anual END AS tmed99,
    CASE WHEN csa_anio = 1999 THEN tmp.tmin_anual END AS tmin99,
    CASE WHEN csa_anio = 1999 THEN tmp.pre_anual END AS pre99,
  CASE WHEN csa_anio = 2000 THEN tmp.tmax_anual END AS tmax00,
    CASE WHEN csa_anio = 2000 THEN tmp.tmed_anual END AS tmed00,
    CASE WHEN csa_anio = 2000 THEN tmp.tmin_anual END AS tmin00,
    CASE WHEN csa_anio = 2000 THEN tmp.pre_anual END AS pre00,
    CASE WHEN csa_anio = 2001 THEN tmp.tmax_anual END AS tmax01,
    CASE WHEN csa_anio = 2001 THEN tmp.tmed_anual END AS tmed01,
    CASE WHEN csa_anio = 2001 THEN tmp.tmin_anual END AS tmin01,
    CASE WHEN csa_anio = 2001 THEN tmp.pre_anual END AS pre01,
  CASE WHEN csa_anio = 2002 THEN tmp.tmax_anual END AS tmax02,
    CASE WHEN csa_anio = 2002 THEN tmp.tmed_anual END AS tmed02,
    CASE WHEN csa_anio = 2002 THEN tmp.tmin_anual END AS tmin02,
    CASE WHEN csa_anio = 2002 THEN tmp.pre_anual END AS pre02,
  CASE WHEN csa_anio = 2003 THEN tmp.tmax_anual END AS tmax03,
    CASE WHEN csa_anio = 2003 THEN tmp.tmed_anual END AS tmed03,
    CASE WHEN csa_anio = 2003 THEN tmp.tmin_anual END AS tmin03,
    CASE WHEN csa_anio = 2003 THEN tmp.pre_anual END AS pre03,
  CASE WHEN csa_anio = 2004 THEN tmp.tmax_anual END AS tmax04,
    CASE WHEN csa_anio = 2004 THEN tmp.tmed_anual END AS tmed04,
    CASE WHEN csa_anio = 2004 THEN tmp.tmin_anual END AS tmin04,
    CASE WHEN csa_anio = 2004 THEN tmp.pre_anual END AS pre04,
    CASE WHEN csa_anio = 2005 THEN tmp.tmax_anual END AS tmax05,
    CASE WHEN csa_anio = 2005 THEN tmp.tmed_anual END AS tmed05,
    CASE WHEN csa_anio = 2005 THEN tmp.tmin_anual END AS tmin05,
    CASE WHEN csa_anio = 2005 THEN tmp.pre_anual END AS pre05,
    CASE WHEN csa_anio = 2006 THEN tmp.tmax_anual END AS tmax06,
    CASE WHEN csa_anio = 2006 THEN tmp.tmed_anual END AS tmed06,
    CASE WHEN csa_anio = 2006 THEN tmp.tmin_anual END AS tmin06,
    CASE WHEN csa_anio = 2006 THEN tmp.pre_anual END AS pre06,
    CASE WHEN csa_anio = 2007 THEN tmp.tmax_anual END AS tmax07,
    CASE WHEN csa_anio = 2007 THEN tmp.tmed_anual END AS tmed07,
    CASE WHEN csa_anio = 2007 THEN tmp.tmin_anual END AS tmin07,
    CASE WHEN csa_anio = 2007 THEN tmp.pre_anual END AS pre07,
    CASE WHEN csa_anio = 2008 THEN tmp.tmax_anual END AS tmax08,
    CASE WHEN csa_anio = 2008 THEN tmp.tmed_anual END AS tmed08,
    CASE WHEN csa_anio = 2008 THEN tmp.tmin_anual END AS tmin08,
    CASE WHEN csa_anio = 2008 THEN tmp.pre_anual END AS pre08,
    CASE WHEN csa_anio = 2009 THEN tmp.tmax_anual END AS tmax09,
    CASE WHEN csa_anio = 2009 THEN tmp.tmed_anual END AS tmed09,
    CASE WHEN csa_anio = 2009 THEN tmp.tmin_anual END AS tmin09,
    CASE WHEN csa_anio = 2009 THEN tmp.pre_anual END AS pre09,
  CASE WHEN csa_anio = 2010 THEN tmp.tmax_anual END AS tmax10,
    CASE WHEN csa_anio = 2010 THEN tmp.tmed_anual END AS tmed10,
    CASE WHEN csa_anio = 2010 THEN tmp.tmin_anual END AS tmin10,
    CASE WHEN csa_anio = 2010 THEN tmp.pre_anual END AS pre10,
    CASE WHEN csa_anio = 2011 THEN tmp.tmax_anual END AS tmax11,
    CASE WHEN csa_anio = 2011 THEN tmp.tmed_anual END AS tmed11,
    CASE WHEN csa_anio = 2011 THEN tmp.tmin_anual END AS tmin11,
    CASE WHEN csa_anio = 2011 THEN tmp.pre_anual END AS pre11,
  CASE WHEN csa_anio = 2012 THEN tmp.tmax_anual END AS tmax12,
    CASE WHEN csa_anio = 2012 THEN tmp.tmed_anual END AS tmed12,
    CASE WHEN csa_anio = 2012 THEN tmp.tmin_anual END AS tmin12,
    CASE WHEN csa_anio = 2012 THEN tmp.pre_anual END AS pre12,
  CASE WHEN csa_anio = 2013 THEN tmp.tmax_anual END AS tmax13,
    CASE WHEN csa_anio = 2013 THEN tmp.tmed_anual END AS tmed13,
    CASE WHEN csa_anio = 2013 THEN tmp.tmin_anual END AS tmin13,
    CASE WHEN csa_anio = 2013 THEN tmp.pre_anual END AS pre13
FROM 
(select his.lug_id,lug.lug_x,lug.lug_y,
        his.csa_anio,
        his.tmax_anual,
        his.tmed_anual,
        his.tmin_anual,
        his.pre_anual
from historico his 
INNER JOIn lugar lug on lug.lug_id = his.lug_id
AND lug.lug_id = 1
) tmp) ttt
group by ttt.lug_id,ttt.lug_x,ttt.lug_y

